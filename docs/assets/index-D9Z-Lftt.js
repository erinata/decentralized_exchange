(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))t(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&t(l)}).observe(document,{childList:!0,subtree:!0});function c(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function t(n){if(n.ep)return;n.ep=!0;const o=c(n);fetch(n.href,o)}})();var x=!1;document.addEventListener("DOMContentLoaded",()=>{console.log("DOM fully loaded and parsed"),document.getElementById("aliceDogTokenBalance"),document.getElementById("aliceCatTokenBalance"),document.getElementById("aliceShareOfLiquidityPool"),document.getElementById("bobDogTokenBalance"),document.getElementById("bobCatTokenBalance"),document.getElementById("bobShareOfLiquidityPool"),document.getElementById("carolDogTokenBalance"),document.getElementById("carolCatTokenBalance"),document.getElementById("carolShareOfLiquidityPool"),document.getElementById("daveDogTokenBalance"),document.getElementById("daveCatTokenBalance"),document.getElementById("daveShareOfLiquidityPool"),document.getElementById("dexDogTokenBalance"),document.getElementById("dexCatTokenBalance"),document.getElementById("relativePriceDogTokenInCatToken"),document.getElementById("relativePriceCatTokenInDogToken"),document.getElementById("executeTradeBuyAliceButton").addEventListener("click",()=>k("Alice","buy")),document.getElementById("executeTradeSellAliceButton").addEventListener("click",()=>k("Alice","sell")),document.getElementById("executeTokenSelectAlice"),document.getElementById("executeAmountInputAlice"),document.getElementById("executeTradeBuyBobButton").addEventListener("click",()=>k("Bob","buy")),document.getElementById("executeTradeSellBobButton").addEventListener("click",()=>k("Bob","sell")),document.getElementById("executeTokenSelectBob"),document.getElementById("executeAmountInputBob"),document.getElementById("executeTradeBuyCarolButton").addEventListener("click",()=>k("Carol","buy")),document.getElementById("executeTradeSellCarolButton").addEventListener("click",()=>k("Carol","sell")),document.getElementById("executeTokenSelectCarol"),document.getElementById("executeAmountInputCarol"),document.getElementById("executeTradeBuyDaveButton").addEventListener("click",()=>k("Dave","buy")),document.getElementById("executeTradeSellDaveButton").addEventListener("click",()=>k("Dave","sell")),document.getElementById("executeTokenSelectDave"),document.getElementById("executeAmountInputDave");const r=document.getElementById("liquidityCatAmountInputAlice");document.getElementById("liquidityDogAmountInputAlice").addEventListener("input",B=>v(B,"Alice")),r.addEventListener("input",B=>f(B,"Alice"));const u=document.getElementById("depositLiquidityAliceButton"),m=document.getElementById("withdrawLiquidityAliceButton");u.addEventListener("click",()=>C("Alice")),m.addEventListener("click",()=>E("Alice"));const g=document.getElementById("liquidityCatAmountInputBob");document.getElementById("liquidityDogAmountInputBob").addEventListener("input",B=>v(B,"Bob")),g.addEventListener("input",B=>f(B,"Bob"));const y=document.getElementById("depositLiquidityBobButton"),H=document.getElementById("withdrawLiquidityBobButton");y.addEventListener("click",()=>C("Bob")),H.addEventListener("click",()=>E("Bob"));const h=document.getElementById("liquidityCatAmountInputCarol");document.getElementById("liquidityDogAmountInputCarol").addEventListener("input",B=>v(B,"Carol")),h.addEventListener("input",B=>f(B,"Carol"));const $=document.getElementById("depositLiquidityCarolButton"),M=document.getElementById("withdrawLiquidityCarolButton");$.addEventListener("click",()=>C("Carol")),M.addEventListener("click",()=>E("Carol"));const A=document.getElementById("liquidityCatAmountInputDave");document.getElementById("liquidityDogAmountInputDave").addEventListener("input",B=>v(B,"Dave")),A.addEventListener("input",B=>f(B,"Dave"));const q=document.getElementById("depositLiquidityDaveButton"),P=document.getElementById("withdrawLiquidityDaveButton");q.addEventListener("click",()=>C("Dave")),P.addEventListener("click",()=>E("Dave")),document.getElementById("aliceTotalValueInUSD"),document.getElementById("bobTotalValueInUSD"),document.getElementById("carolTotalValueInUSD"),document.getElementById("daveTotalValueInUSD"),document.getElementById("coinbaseArbitrageButton").addEventListener("click",()=>b()),document.getElementById("coinbaseArbitrageOneStepButton").addEventListener("click",()=>b(1));const S=document.getElementById("coinbaseDogTokenPriceInput"),F=document.getElementById("coinbaseCatTokenPriceInput");S.addEventListener("input",L),F.addEventListener("input",L),document.getElementById("airdropUserSelect"),document.getElementById("airdropTokenSelect"),document.getElementById("airdropAmountInput"),document.getElementById("airdropButton").addEventListener("click",w),document.getElementById("activityLogList"),N(),I(),L(),x=!0,s("Initialized.")});function s(e){if(x){const a=document.getElementById("activityLogList"),c=document.createElement("li");c.textContent=`${e}`,a.append(c),a.children.length>20&&a.removeChild(a.children[0])}}function L(){const e=parseFloat(coinbaseDogTokenPriceInput.value),a=parseFloat(coinbaseCatTokenPriceInput.value);["alice","bob","carol","dave"].forEach(t=>{const n=document.getElementById(`${t}TotalValueInUSD`).innerHTML,o=parseFloat(document.getElementById(`${t}DogTokenBalance`).innerHTML),l=parseFloat(document.getElementById(`${t}CatTokenBalance`).innerHTML),d=parseFloat(document.getElementById(`${t}ShareOfLiquidityPool`).innerHTML),r=parseFloat(dexDogTokenBalance.innerHTML),T=parseFloat(dexCatTokenBalance.innerHTML),u=d/100*(r*e+T*a),m=o*e+l*a+u;document.getElementById(`${t}TotalValueInUSD`).innerHTML=`$${i(m,2)}`,n!==`$${i(m,2)}`&&n!=="N/A"&&s(`${t.charAt(0).toUpperCase()+t.slice(1)}'s total asset value updated from ${n} to $${i(m,2)} USD.`)})}function w(){const e=airdropUserSelect.value;(e==="all"?["Alice","Bob","Carol","Dave"]:[e]).forEach(c=>O(c)),L()}function O(e){const a=airdropTokenSelect.value,c=parseFloat(airdropAmountInput.value);if(isNaN(c)||c<=0){alert("Please enter a valid amount greater than 0.");return}const t=e.toLowerCase(),n=parseFloat(document.getElementById(`${t}DogTokenBalance`).innerHTML),o=parseFloat(document.getElementById(`${t}CatTokenBalance`).innerHTML);a==="dogToken"?document.getElementById(`${t}DogTokenBalance`).innerHTML=i(n+c):a==="catToken"&&(document.getElementById(`${t}CatTokenBalance`).innerHTML=i(o+c)),s(`Airdropping ${c} ${a==="dogToken"?"Dog":"Cat"} Tokens to ${e}.`)}function b(e=1/0){const a=parseFloat(coinbaseDogTokenPriceInput.value),c=parseFloat(coinbaseCatTokenPriceInput.value),t=a/c,n=parseFloat(relativePriceDogTokenInCatToken.innerHTML),o=.01;if(t>n+o){console.log("Arbitrage opportunity: Buy Dog Token on DEX and sell on Coinbase");let l=parseFloat(dexDogTokenBalance.innerHTML),d=parseFloat(dexCatTokenBalance.innerHTML),r=0,T=0;for(;t>d/l&&e>0;){const u=1*d/(l-1);if(l<1||d<u)break;r+=1,T+=u,l-=1,d+=u,e-=1}r>0?(console.log(`Bought ${r} Dog Tokens on DEX for ${T} Cat Tokens`),dexDogTokenBalance.innerHTML=i(l),dexCatTokenBalance.innerHTML=i(d),I()):console.log("No arbitrage opportunity found")}else if(t<n-o){console.log("Arbitrage opportunity: Buy Cat Token on DEX and sell on Coinbase");let l=parseFloat(dexDogTokenBalance.innerHTML),d=parseFloat(dexCatTokenBalance.innerHTML),r=0,T=0;for(;t<d/l&&e>0;){const u=1*l/(d-1);if(d<1||l<u)break;r+=1,T+=u,d-=1,l+=u,e-=1}r>0?(console.log(`Bought ${r} Cat Tokens on DEX for ${T} Dog Tokens`),dexDogTokenBalance.innerHTML=i(l),dexCatTokenBalance.innerHTML=i(d),I()):console.log("No arbitrage opportunity found")}else console.log("No arbitrage opportunity found");s("Arbitrage executed."),L()}function C(e){const a=document.getElementById(`liquidityDogAmountInput${e}`),c=document.getElementById(`liquidityCatAmountInput${e}`),t=parseFloat(a.value),n=parseFloat(c.value);if(isNaN(t)||t<=0||isNaN(n)||n<=0){alert("Please enter a valid Token amount greater than 0.");return}console.log(`Depositing liquidity: ${e} wants to deposit ${t} Dog Tokens and ${n} Cat Tokens`);const o=e.toLowerCase(),l=parseFloat(document.getElementById(`${o}DogTokenBalance`).innerHTML),d=parseFloat(document.getElementById(`${o}CatTokenBalance`).innerHTML),r=parseFloat(document.getElementById(`${o}ShareOfLiquidityPool`).innerHTML),T=parseFloat(dexDogTokenBalance.innerHTML),u=parseFloat(dexCatTokenBalance.innerHTML),m=T+u;if(l<t){alert(`${e} does not have enough Dog Tokens to deposit.`);return}if(d<n){alert(`${e} does not have enough Cat Tokens to deposit.`);return}if(T===0&&u===0){if(t<=0||n<=0){alert("Initial liquidity must be greater than 0 for both Dog and Cat Tokens.");return}document.getElementById(`${o}ShareOfLiquidityPool`).innerHTML="100",dexDogTokenBalance.innerHTML=i(t),dexCatTokenBalance.innerHTML=i(n),document.getElementById(`${o}DogTokenBalance`).innerHTML=i(l-t),document.getElementById(`${o}CatTokenBalance`).innerHTML=i(d-n),I(),document.getElementById(`liquidityDogAmountInput${e}`).value="",document.getElementById(`liquidityCatAmountInput${e}`).value="";return}document.getElementById(`${o}DogTokenBalance`).innerHTML=i(l-t),document.getElementById(`${o}CatTokenBalance`).innerHTML=i(d-n);const p=(T+u)*r/100+t+n,y=m+t+n,H=p/y*100;document.getElementById(`${o}ShareOfLiquidityPool`).innerHTML=i(H),["alice","bob","carol","dave"].forEach(D=>{if(D!==o){const M=parseFloat(document.getElementById(`${D}ShareOfLiquidityPool`).innerHTML)*m/y;document.getElementById(`${D}ShareOfLiquidityPool`).innerHTML=i(M)}}),s(`Dex dog token balance: ${T} -> ${T+t}`),s(`Dex cat token balance: ${u} -> ${u+n}`),dexDogTokenBalance.innerHTML=i(T+t),dexCatTokenBalance.innerHTML=i(u+n),I(),document.getElementById(`liquidityDogAmountInput${e}`).value="",document.getElementById(`liquidityCatAmountInput${e}`).value=""}function E(e){const a=e.toLowerCase(),c=parseFloat(document.getElementById(`${a}ShareOfLiquidityPool`).innerHTML);if(c<=0){alert(`${e} does not have any share of the liquidity pool to withdraw.`);return}console.log(`Withdrawing liquidity: ${e} wants to withdraw their share of the liquidity pool`);const t=parseFloat(dexDogTokenBalance.innerHTML),n=parseFloat(dexCatTokenBalance.innerHTML),o=t+n,l=c/100*t,d=c/100*n,r=parseFloat(document.getElementById(`${a}DogTokenBalance`).innerHTML),T=parseFloat(document.getElementById(`${a}CatTokenBalance`).innerHTML);document.getElementById(`${a}DogTokenBalance`).innerHTML=i(r+l),document.getElementById(`${a}CatTokenBalance`).innerHTML=i(T+d),s(`Dex dog token balance: ${t} -> ${t-l}`),s(`Dex cat token balance: ${n} -> ${n-d}`),dexDogTokenBalance.innerHTML=i(t-l),dexCatTokenBalance.innerHTML=i(n-d),document.getElementById(`${a}ShareOfLiquidityPool`).innerHTML="0",["alice","bob","carol","dave"].reduce((g,p)=>p!==a?g+parseFloat(document.getElementById(`${p}ShareOfLiquidityPool`).innerHTML):g,0)===0&&(dexDogTokenBalance.innerHTML="0",dexCatTokenBalance.innerHTML="0",document.getElementById("relativePriceDogTokenInCatToken").innerHTML="N/A",document.getElementById("relativePriceCatTokenInDogToken").innerHTML="N/A"),["alice","bob","carol","dave"].forEach(g=>{if(g!==a)if(o-(l+d)<=0)document.getElementById(`${g}ShareOfLiquidityPool`).innerHTML="0";else{const y=parseFloat(document.getElementById(`${g}ShareOfLiquidityPool`).innerHTML)*o/(o-(l+d));y<0?document.getElementById(`${g}ShareOfLiquidityPool`).innerHTML="0":y>100?document.getElementById(`${g}ShareOfLiquidityPool`).innerHTML="100":document.getElementById(`${g}ShareOfLiquidityPool`).innerHTML=i(y)}}),s(`${e} withdrew all share of the liquidity pool: ${i(l)} Dog Tokens and ${i(d)} Cat Tokens.`),I()}function v(e,a){const c=e.target.value;if(isNaN(c)||c<=0){e.target.value="";return}else{const t=parseFloat(c),n=parseFloat(dexDogTokenBalance.innerHTML),o=parseFloat(dexCatTokenBalance.innerHTML);if(n===0&&o===0)return;if(n===0)return;if(o===0)return;{const l=t*o/n;document.getElementById(`liquidityCatAmountInput${a}`).value=i(l)}}}function f(e,a){const c=e.target.value;if(isNaN(c)||c<=0){e.target.value="";return}else{const t=parseFloat(c),n=parseFloat(dexDogTokenBalance.innerHTML),o=parseFloat(dexCatTokenBalance.innerHTML);if(n===0&&o===0)return;if(n===0)return;if(o===0)return;{const l=t*n/o;document.getElementById(`liquidityDogAmountInput${a}`).value=i(l)}}}function N(){aliceDogTokenBalance.innerHTML="0",aliceCatTokenBalance.innerHTML="0",aliceShareOfLiquidityPool.innerHTML="0",bobDogTokenBalance.innerHTML="0",bobCatTokenBalance.innerHTML="0",bobShareOfLiquidityPool.innerHTML="0",carolDogTokenBalance.innerHTML="0",carolCatTokenBalance.innerHTML="0",carolShareOfLiquidityPool.innerHTML="0",daveDogTokenBalance.innerHTML="0",daveCatTokenBalance.innerHTML="0",daveShareOfLiquidityPool.innerHTML="0",dexDogTokenBalance.innerHTML="0",dexCatTokenBalance.innerHTML="0",relativePriceDogTokenInCatToken.innerHTML="1",relativePriceCatTokenInDogToken.innerHTML="1",coinbaseDogTokenPriceInput.value="1",coinbaseCatTokenPriceInput.value="1"}function i(e,a=16){return e.toFixed(a).replace(/\.?0+$/,"")}function I(){const e=parseFloat(dexDogTokenBalance.innerHTML),a=parseFloat(dexCatTokenBalance.innerHTML);if(e===0&&a===0)s(`Relative price updated: 1 Dog Token = ${relativePriceDogTokenInCatToken.innerHTML} Cat Tokens -> N/A`),s(`Relative price updated: 1 Cat Token = ${relativePriceCatTokenInDogToken.innerHTML} Dog Tokens -> N/A`),relativePriceDogTokenInCatToken.innerHTML="N/A",relativePriceCatTokenInDogToken.innerHTML="N/A";else if(e===0)s(`Relative price updated: 1 Dog Token = ${relativePriceDogTokenInCatToken.innerHTML} Cat Tokens -> Infinity Cat Tokens`),s(`Relative price updated: 1 Cat Token = ${relativePriceCatTokenInDogToken.innerHTML} Dog Tokens -> 0 Dog Tokens`),relativePriceDogTokenInCatToken.innerHTML="Infinity",relativePriceCatTokenInDogToken.innerHTML="0";else if(a===0)s(`Relative price updated: 1 Dog Token = ${relativePriceDogTokenInCatToken.innerHTML} Cat Tokens -> Infinity Cat Tokens`),s(`Relative price updated: 1 Cat Token = ${relativePriceCatTokenInDogToken.innerHTML} Dog Tokens -> 0 Dog Tokens`),relativePriceDogTokenInCatToken.innerHTML="0",relativePriceCatTokenInDogToken.innerHTML="Infinity";else{const c=a/e,t=i(c),n=i(1/c);s(`Relative price updated: 1 Dog Token = ${relativePriceDogTokenInCatToken.innerHTML} Cat Tokens -> ${t} Cat Tokens`),s(`Relative price updated: 1 Cat Token = ${relativePriceCatTokenInDogToken.innerHTML} Dog Tokens -> ${n} Dog Tokens`),relativePriceDogTokenInCatToken.innerHTML=t,relativePriceCatTokenInDogToken.innerHTML=n}L()}function U(e,a,c,t){e=e.toLowerCase();const n=parseFloat(document.getElementById(`${e}DogTokenBalance`).innerHTML),o=parseFloat(document.getElementById(`${e}CatTokenBalance`).innerHTML),l=parseFloat(dexDogTokenBalance.innerHTML),d=parseFloat(dexCatTokenBalance.innerHTML);if(a==="dogToken"){if(c==="sell"){if(n<t){alert(`${e.charAt(0).toUpperCase()+e.slice(1)} does not have enough Dog Tokens to sell.`);return}const r=t*d/(l+t);document.getElementById(`${e}DogTokenBalance`).innerHTML=i(n-t),document.getElementById(`${e}CatTokenBalance`).innerHTML=i(o+r),dexDogTokenBalance.innerHTML=i(l+t),dexCatTokenBalance.innerHTML=i(d-r)}else if(c==="buy"){if(l<t){alert(`DEX does not have enough Dog Tokens for ${e.charAt(0).toUpperCase()+e.slice(1)} to buy.`);return}const r=t*d/(l-t);if(o<r){alert(`${e.charAt(0).toUpperCase()+e.slice(1)} does not have enough Cat Tokens to buy Dog Tokens.`);return}document.getElementById(`${e}DogTokenBalance`).innerHTML=i(n+t),document.getElementById(`${e}CatTokenBalance`).innerHTML=i(o-r),dexDogTokenBalance.innerHTML=i(l-t),dexCatTokenBalance.innerHTML=i(d+r)}}else if(a==="catToken"){if(c==="sell"){if(o<t){alert(`${e.charAt(0).toUpperCase()+e.slice(1)} does not have enough Cat Tokens to sell.`);return}const r=t*l/(d+t);document.getElementById(`${e}CatTokenBalance`).innerHTML=i(o-t),document.getElementById(`${e}DogTokenBalance`).innerHTML=i(n+r),dexCatTokenBalance.innerHTML=i(d+t),dexDogTokenBalance.innerHTML=i(l-r)}else if(c==="buy"){if(d<t){alert(`DEX does not have enough Cat Tokens for ${e.charAt(0).toUpperCase()+e.slice(1)} to buy.`);return}const r=t*l/(d-t);if(n<r){alert(`${e.charAt(0).toUpperCase()+e.slice(1)} does not have enough Dog Tokens to buy Cat Tokens.`);return}document.getElementById(`${e}CatTokenBalance`).innerHTML=i(o+t),document.getElementById(`${e}DogTokenBalance`).innerHTML=i(n-r),dexCatTokenBalance.innerHTML=i(d-t),dexDogTokenBalance.innerHTML=i(l+r)}}s(`${e} ${c} ${t} ${a==="dogToken"?"Dog":"Cat"} Tokens.`),I()}function k(e,a){const c=document.getElementById(`executeTokenSelect${e}`).value,t=parseFloat(document.getElementById(`executeAmountInput${e}`).value);if(isNaN(t)||t<=0){alert("Please enter a valid amount greater than 0.");return}console.log(`Executing trade: ${e} wants to ${a} ${t} of ${c} Token`),U(e,c,a,t),L()}
