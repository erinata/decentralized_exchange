(function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))t(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&t(c)}).observe(document,{childList:!0,subtree:!0});function i(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function t(n){if(n.ep)return;n.ep=!0;const o=i(n);fetch(n.href,o)}})();document.addEventListener("DOMContentLoaded",()=>{console.log("DOM fully loaded and parsed"),document.getElementById("aliceDogTokenBalance"),document.getElementById("aliceCatTokenBalance"),document.getElementById("aliceShareOfLiquidityPool"),document.getElementById("bobDogTokenBalance"),document.getElementById("bobCatTokenBalance"),document.getElementById("bobShareOfLiquidityPool"),document.getElementById("carolDogTokenBalance"),document.getElementById("carolCatTokenBalance"),document.getElementById("carolShareOfLiquidityPool"),document.getElementById("daveDogTokenBalance"),document.getElementById("daveCatTokenBalance"),document.getElementById("daveShareOfLiquidityPool"),document.getElementById("dexDogTokenBalance"),document.getElementById("dexCatTokenBalance"),document.getElementById("relativePriceDogTokenInCatToken"),document.getElementById("relativePriceCatTokenInDogToken"),document.getElementById("executeTradeBuyAliceButton").addEventListener("click",()=>L("Alice","buy")),document.getElementById("executeTradeSellAliceButton").addEventListener("click",()=>L("Alice","sell")),document.getElementById("executeTokenSelectAlice"),document.getElementById("executeAmountInputAlice"),document.getElementById("executeTradeBuyBobButton").addEventListener("click",()=>L("Bob","buy")),document.getElementById("executeTradeSellBobButton").addEventListener("click",()=>L("Bob","sell")),document.getElementById("executeTokenSelectBob"),document.getElementById("executeAmountInputBob"),document.getElementById("executeTradeBuyCarolButton").addEventListener("click",()=>L("Carol","buy")),document.getElementById("executeTradeSellCarolButton").addEventListener("click",()=>L("Carol","sell")),document.getElementById("executeTokenSelectCarol"),document.getElementById("executeAmountInputCarol"),document.getElementById("executeTradeBuyDaveButton").addEventListener("click",()=>L("Dave","buy")),document.getElementById("executeTradeSellDaveButton").addEventListener("click",()=>L("Dave","sell")),document.getElementById("executeTokenSelectDave"),document.getElementById("executeAmountInputDave");const r=document.getElementById("liquidityCatAmountInputAlice");document.getElementById("liquidityDogAmountInputAlice").addEventListener("input",B=>v(B,"Alice")),r.addEventListener("input",B=>f(B,"Alice"));const u=document.getElementById("depositLiquidityAliceButton"),m=document.getElementById("withdrawLiquidityAliceButton");u.addEventListener("click",()=>C("Alice")),m.addEventListener("click",()=>E("Alice"));const g=document.getElementById("liquidityCatAmountInputBob");document.getElementById("liquidityDogAmountInputBob").addEventListener("input",B=>v(B,"Bob")),g.addEventListener("input",B=>f(B,"Bob"));const k=document.getElementById("depositLiquidityBobButton"),H=document.getElementById("withdrawLiquidityBobButton");k.addEventListener("click",()=>C("Bob")),H.addEventListener("click",()=>E("Bob"));const h=document.getElementById("liquidityCatAmountInputCarol");document.getElementById("liquidityDogAmountInputCarol").addEventListener("input",B=>v(B,"Carol")),h.addEventListener("input",B=>f(B,"Carol"));const $=document.getElementById("depositLiquidityCarolButton"),M=document.getElementById("withdrawLiquidityCarolButton");$.addEventListener("click",()=>C("Carol")),M.addEventListener("click",()=>E("Carol"));const x=document.getElementById("liquidityCatAmountInputDave");document.getElementById("liquidityDogAmountInputDave").addEventListener("input",B=>v(B,"Dave")),x.addEventListener("input",B=>f(B,"Dave"));const A=document.getElementById("depositLiquidityDaveButton"),q=document.getElementById("withdrawLiquidityDaveButton");A.addEventListener("click",()=>C("Dave")),q.addEventListener("click",()=>E("Dave")),document.getElementById("aliceTotalValueInUSD"),document.getElementById("bobTotalValueInUSD"),document.getElementById("carolTotalValueInUSD"),document.getElementById("daveTotalValueInUSD"),document.getElementById("coinbaseArbitrageButton").addEventListener("click",()=>b()),document.getElementById("coinbaseArbitrageOneStepButton").addEventListener("click",()=>b(1));const S=document.getElementById("coinbaseDogTokenPriceInput"),P=document.getElementById("coinbaseCatTokenPriceInput");S.addEventListener("input",y),P.addEventListener("input",y),document.getElementById("airdropUserSelect"),document.getElementById("airdropTokenSelect"),document.getElementById("airdropAmountInput"),document.getElementById("airdropButton").addEventListener("click",O),document.getElementById("activityLogList"),document.getElementById("quickSetupOneButton").addEventListener("click",w),document.getElementById("quickSetupTwoButton").addEventListener("click",F),document.getElementById("activityLogToggle"),U(),I(),y(),s("Initialized.")});function w(){["Alice","Bob","Carol","Dave"].forEach(e=>{document.getElementById(`${e.toLowerCase()}DogTokenBalance`).innerHTML="10000",document.getElementById(`${e.toLowerCase()}CatTokenBalance`).innerHTML="10000"}),liquidityDogAmountInputCarol.value="5000",liquidityCatAmountInputCarol.value="5000",C("Carol"),y()}function F(){["Alice","Bob"].forEach(e=>{document.getElementById(`${e.toLowerCase()}DogTokenBalance`).innerHTML="10000",document.getElementById(`${e.toLowerCase()}CatTokenBalance`).innerHTML="10000"}),["Carol"].forEach(e=>{document.getElementById(`${e.toLowerCase()}DogTokenBalance`).innerHTML="1000000",document.getElementById(`${e.toLowerCase()}CatTokenBalance`).innerHTML="1000000"}),liquidityDogAmountInputCarol.value="1000000",liquidityCatAmountInputCarol.value="1000000",C("Carol"),y()}function s(e){if(activityLogToggle.checked){const i=document.getElementById("activityLogList"),t=document.createElement("li");t.textContent=`${e}`,i.append(t),i.children.length>20&&i.removeChild(i.children[0])}}function y(){const e=parseFloat(coinbaseDogTokenPriceInput.value),l=parseFloat(coinbaseCatTokenPriceInput.value);["alice","bob","carol","dave"].forEach(t=>{const n=document.getElementById(`${t}TotalValueInUSD`).innerHTML,o=parseFloat(document.getElementById(`${t}DogTokenBalance`).innerHTML),c=parseFloat(document.getElementById(`${t}CatTokenBalance`).innerHTML),d=parseFloat(document.getElementById(`${t}ShareOfLiquidityPool`).innerHTML),r=parseFloat(dexDogTokenBalance.innerHTML),T=parseFloat(dexCatTokenBalance.innerHTML),u=d/100*(r*e+T*l),m=o*e+c*l+u;document.getElementById(`${t}TotalValueInUSD`).innerHTML=`$${a(m,2)}`,n!==`$${a(m,2)}`&&n!=="N/A"&&s(`${t.charAt(0).toUpperCase()+t.slice(1)}'s total asset value updated from ${n} to $${a(m,2)} USD.`)})}function O(){const e=airdropUserSelect.value;(e==="all"?["Alice","Bob","Carol","Dave"]:[e]).forEach(i=>N(i)),y()}function N(e){const l=airdropTokenSelect.value,i=parseFloat(airdropAmountInput.value);if(isNaN(i)||i<=0){alert("Please enter a valid amount greater than 0.");return}const t=e.toLowerCase(),n=parseFloat(document.getElementById(`${t}DogTokenBalance`).innerHTML),o=parseFloat(document.getElementById(`${t}CatTokenBalance`).innerHTML);l==="dogToken"?document.getElementById(`${t}DogTokenBalance`).innerHTML=a(n+i):l==="catToken"&&(document.getElementById(`${t}CatTokenBalance`).innerHTML=a(o+i)),s(`Airdropping ${i} ${l==="dogToken"?"Dog":"Cat"} Tokens to ${e}.`)}function b(e=1/0){const l=parseFloat(coinbaseDogTokenPriceInput.value),i=parseFloat(coinbaseCatTokenPriceInput.value),t=l/i,n=parseFloat(relativePriceDogTokenInCatToken.innerHTML),o=.01;if(t>n+o){console.log("Arbitrage opportunity: Buy Dog Token on DEX and sell on Coinbase");let c=parseFloat(dexDogTokenBalance.innerHTML),d=parseFloat(dexCatTokenBalance.innerHTML),r=0,T=0;for(;t>d/c&&e>0;){const u=1*d/(c-1);if(c<1||d<u)break;r+=1,T+=u,c-=1,d+=u,e-=1}r>0?(console.log(`Bought ${r} Dog Tokens on DEX for ${T} Cat Tokens`),dexDogTokenBalance.innerHTML=a(c),dexCatTokenBalance.innerHTML=a(d),I()):console.log("No arbitrage opportunity found")}else if(t<n-o){console.log("Arbitrage opportunity: Buy Cat Token on DEX and sell on Coinbase");let c=parseFloat(dexDogTokenBalance.innerHTML),d=parseFloat(dexCatTokenBalance.innerHTML),r=0,T=0;for(;t<d/c&&e>0;){const u=1*c/(d-1);if(d<1||c<u)break;r+=1,T+=u,d-=1,c+=u,e-=1}r>0?(console.log(`Bought ${r} Cat Tokens on DEX for ${T} Dog Tokens`),dexDogTokenBalance.innerHTML=a(c),dexCatTokenBalance.innerHTML=a(d),I()):console.log("No arbitrage opportunity found")}else console.log("No arbitrage opportunity found");s("Arbitrage executed."),y()}function C(e){const l=document.getElementById(`liquidityDogAmountInput${e}`),i=document.getElementById(`liquidityCatAmountInput${e}`),t=parseFloat(l.value),n=parseFloat(i.value);if(isNaN(t)||t<=0||isNaN(n)||n<=0){alert("Please enter a valid Token amount greater than 0.");return}console.log(`Depositing liquidity: ${e} wants to deposit ${t} Dog Tokens and ${n} Cat Tokens`);const o=e.toLowerCase(),c=parseFloat(document.getElementById(`${o}DogTokenBalance`).innerHTML),d=parseFloat(document.getElementById(`${o}CatTokenBalance`).innerHTML),r=parseFloat(document.getElementById(`${o}ShareOfLiquidityPool`).innerHTML),T=parseFloat(dexDogTokenBalance.innerHTML),u=parseFloat(dexCatTokenBalance.innerHTML),m=T+u;if(c<t){alert(`${e} does not have enough Dog Tokens to deposit.`);return}if(d<n){alert(`${e} does not have enough Cat Tokens to deposit.`);return}if(T===0&&u===0){if(t<=0||n<=0){alert("Initial liquidity must be greater than 0 for both Dog and Cat Tokens.");return}document.getElementById(`${o}ShareOfLiquidityPool`).innerHTML="100",dexDogTokenBalance.innerHTML=a(t),dexCatTokenBalance.innerHTML=a(n),document.getElementById(`${o}DogTokenBalance`).innerHTML=a(c-t),document.getElementById(`${o}CatTokenBalance`).innerHTML=a(d-n),I(),document.getElementById(`liquidityDogAmountInput${e}`).value="",document.getElementById(`liquidityCatAmountInput${e}`).value="";return}document.getElementById(`${o}DogTokenBalance`).innerHTML=a(c-t),document.getElementById(`${o}CatTokenBalance`).innerHTML=a(d-n);const p=(T+u)*r/100+t+n,k=m+t+n,H=p/k*100;document.getElementById(`${o}ShareOfLiquidityPool`).innerHTML=a(H),["alice","bob","carol","dave"].forEach(D=>{if(D!==o){const M=parseFloat(document.getElementById(`${D}ShareOfLiquidityPool`).innerHTML)*m/k;document.getElementById(`${D}ShareOfLiquidityPool`).innerHTML=a(M)}}),s(`Dex dog token balance: ${T} -> ${T+t}`),s(`Dex cat token balance: ${u} -> ${u+n}`),dexDogTokenBalance.innerHTML=a(T+t),dexCatTokenBalance.innerHTML=a(u+n),I(),document.getElementById(`liquidityDogAmountInput${e}`).value="",document.getElementById(`liquidityCatAmountInput${e}`).value=""}function E(e){const l=e.toLowerCase(),i=parseFloat(document.getElementById(`${l}ShareOfLiquidityPool`).innerHTML);if(i<=0){alert(`${e} does not have any share of the liquidity pool to withdraw.`);return}console.log(`Withdrawing liquidity: ${e} wants to withdraw their share of the liquidity pool`);const t=parseFloat(dexDogTokenBalance.innerHTML),n=parseFloat(dexCatTokenBalance.innerHTML),o=t+n,c=i/100*t,d=i/100*n,r=parseFloat(document.getElementById(`${l}DogTokenBalance`).innerHTML),T=parseFloat(document.getElementById(`${l}CatTokenBalance`).innerHTML);document.getElementById(`${l}DogTokenBalance`).innerHTML=a(r+c),document.getElementById(`${l}CatTokenBalance`).innerHTML=a(T+d),s(`Dex dog token balance: ${t} -> ${t-c}`),s(`Dex cat token balance: ${n} -> ${n-d}`),dexDogTokenBalance.innerHTML=a(t-c),dexCatTokenBalance.innerHTML=a(n-d),document.getElementById(`${l}ShareOfLiquidityPool`).innerHTML="0",["alice","bob","carol","dave"].reduce((g,p)=>p!==l?g+parseFloat(document.getElementById(`${p}ShareOfLiquidityPool`).innerHTML):g,0)===0&&(dexDogTokenBalance.innerHTML="0",dexCatTokenBalance.innerHTML="0",document.getElementById("relativePriceDogTokenInCatToken").innerHTML="N/A",document.getElementById("relativePriceCatTokenInDogToken").innerHTML="N/A"),["alice","bob","carol","dave"].forEach(g=>{if(g!==l)if(o-(c+d)<=0)document.getElementById(`${g}ShareOfLiquidityPool`).innerHTML="0";else{const k=parseFloat(document.getElementById(`${g}ShareOfLiquidityPool`).innerHTML)*o/(o-(c+d));k<0?document.getElementById(`${g}ShareOfLiquidityPool`).innerHTML="0":k>100?document.getElementById(`${g}ShareOfLiquidityPool`).innerHTML="100":document.getElementById(`${g}ShareOfLiquidityPool`).innerHTML=a(k)}}),s(`${e} withdrew all share of the liquidity pool: ${a(c)} Dog Tokens and ${a(d)} Cat Tokens.`),I()}function v(e,l){const i=e.target.value;if(isNaN(i)||i<=0){e.target.value="";return}else{const t=parseFloat(i),n=parseFloat(dexDogTokenBalance.innerHTML),o=parseFloat(dexCatTokenBalance.innerHTML);if(n===0&&o===0)return;if(n===0)return;if(o===0)return;{const c=t*o/n;document.getElementById(`liquidityCatAmountInput${l}`).value=a(c)}}}function f(e,l){const i=e.target.value;if(isNaN(i)||i<=0){e.target.value="";return}else{const t=parseFloat(i),n=parseFloat(dexDogTokenBalance.innerHTML),o=parseFloat(dexCatTokenBalance.innerHTML);if(n===0&&o===0)return;if(n===0)return;if(o===0)return;{const c=t*n/o;document.getElementById(`liquidityDogAmountInput${l}`).value=a(c)}}}function U(){aliceDogTokenBalance.innerHTML="0",aliceCatTokenBalance.innerHTML="0",aliceShareOfLiquidityPool.innerHTML="0",bobDogTokenBalance.innerHTML="0",bobCatTokenBalance.innerHTML="0",bobShareOfLiquidityPool.innerHTML="0",carolDogTokenBalance.innerHTML="0",carolCatTokenBalance.innerHTML="0",carolShareOfLiquidityPool.innerHTML="0",daveDogTokenBalance.innerHTML="0",daveCatTokenBalance.innerHTML="0",daveShareOfLiquidityPool.innerHTML="0",dexDogTokenBalance.innerHTML="0",dexCatTokenBalance.innerHTML="0",relativePriceDogTokenInCatToken.innerHTML="1",relativePriceCatTokenInDogToken.innerHTML="1",coinbaseDogTokenPriceInput.value="1",coinbaseCatTokenPriceInput.value="1"}function a(e,l=16){return e.toFixed(l).replace(/\.?0+$/,"")}function I(){const e=parseFloat(dexDogTokenBalance.innerHTML),l=parseFloat(dexCatTokenBalance.innerHTML);if(e===0&&l===0)s(`Relative price updated: 1 Dog Token = ${relativePriceDogTokenInCatToken.innerHTML} Cat Tokens -> N/A`),s(`Relative price updated: 1 Cat Token = ${relativePriceCatTokenInDogToken.innerHTML} Dog Tokens -> N/A`),relativePriceDogTokenInCatToken.innerHTML="N/A",relativePriceCatTokenInDogToken.innerHTML="N/A";else if(e===0)s(`Relative price updated: 1 Dog Token = ${relativePriceDogTokenInCatToken.innerHTML} Cat Tokens -> Infinity Cat Tokens`),s(`Relative price updated: 1 Cat Token = ${relativePriceCatTokenInDogToken.innerHTML} Dog Tokens -> 0 Dog Tokens`),relativePriceDogTokenInCatToken.innerHTML="Infinity",relativePriceCatTokenInDogToken.innerHTML="0";else if(l===0)s(`Relative price updated: 1 Dog Token = ${relativePriceDogTokenInCatToken.innerHTML} Cat Tokens -> Infinity Cat Tokens`),s(`Relative price updated: 1 Cat Token = ${relativePriceCatTokenInDogToken.innerHTML} Dog Tokens -> 0 Dog Tokens`),relativePriceDogTokenInCatToken.innerHTML="0",relativePriceCatTokenInDogToken.innerHTML="Infinity";else{const i=l/e,t=a(i),n=a(1/i);s(`Relative price updated: 1 Dog Token = ${relativePriceDogTokenInCatToken.innerHTML} Cat Tokens -> ${t} Cat Tokens`),s(`Relative price updated: 1 Cat Token = ${relativePriceCatTokenInDogToken.innerHTML} Dog Tokens -> ${n} Dog Tokens`),relativePriceDogTokenInCatToken.innerHTML=t,relativePriceCatTokenInDogToken.innerHTML=n}y()}function R(e,l,i,t){e=e.toLowerCase();const n=parseFloat(document.getElementById(`${e}DogTokenBalance`).innerHTML),o=parseFloat(document.getElementById(`${e}CatTokenBalance`).innerHTML),c=parseFloat(dexDogTokenBalance.innerHTML),d=parseFloat(dexCatTokenBalance.innerHTML);if(l==="dogToken"){if(i==="sell"){if(n<t){alert(`${e.charAt(0).toUpperCase()+e.slice(1)} does not have enough Dog Tokens to sell.`);return}const r=t*d/(c+t);document.getElementById(`${e}DogTokenBalance`).innerHTML=a(n-t),document.getElementById(`${e}CatTokenBalance`).innerHTML=a(o+r),dexDogTokenBalance.innerHTML=a(c+t),dexCatTokenBalance.innerHTML=a(d-r)}else if(i==="buy"){if(c<t){alert(`DEX does not have enough Dog Tokens for ${e.charAt(0).toUpperCase()+e.slice(1)} to buy.`);return}const r=t*d/(c-t);if(o<r){alert(`${e.charAt(0).toUpperCase()+e.slice(1)} does not have enough Cat Tokens to buy Dog Tokens.`);return}document.getElementById(`${e}DogTokenBalance`).innerHTML=a(n+t),document.getElementById(`${e}CatTokenBalance`).innerHTML=a(o-r),dexDogTokenBalance.innerHTML=a(c-t),dexCatTokenBalance.innerHTML=a(d+r)}}else if(l==="catToken"){if(i==="sell"){if(o<t){alert(`${e.charAt(0).toUpperCase()+e.slice(1)} does not have enough Cat Tokens to sell.`);return}const r=t*c/(d+t);document.getElementById(`${e}CatTokenBalance`).innerHTML=a(o-t),document.getElementById(`${e}DogTokenBalance`).innerHTML=a(n+r),dexCatTokenBalance.innerHTML=a(d+t),dexDogTokenBalance.innerHTML=a(c-r)}else if(i==="buy"){if(d<t){alert(`DEX does not have enough Cat Tokens for ${e.charAt(0).toUpperCase()+e.slice(1)} to buy.`);return}const r=t*c/(d-t);if(n<r){alert(`${e.charAt(0).toUpperCase()+e.slice(1)} does not have enough Dog Tokens to buy Cat Tokens.`);return}document.getElementById(`${e}CatTokenBalance`).innerHTML=a(o+t),document.getElementById(`${e}DogTokenBalance`).innerHTML=a(n-r),dexCatTokenBalance.innerHTML=a(d-t),dexDogTokenBalance.innerHTML=a(c+r)}}s(`${e} ${i} ${t} ${l==="dogToken"?"Dog":"Cat"} Tokens.`),I()}function L(e,l){const i=document.getElementById(`executeTokenSelect${e}`).value,t=parseFloat(document.getElementById(`executeAmountInput${e}`).value);if(isNaN(t)||t<=0){alert("Please enter a valid amount greater than 0.");return}console.log(`Executing trade: ${e} wants to ${l} ${t} of ${i} Token`),R(e,i,l,t),y()}
