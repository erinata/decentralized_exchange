(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))t(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&t(c)}).observe(document,{childList:!0,subtree:!0});function l(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function t(n){if(n.ep)return;n.ep=!0;const o=l(n);fetch(n.href,o)}})();var A=!1;document.addEventListener("DOMContentLoaded",()=>{console.log("DOM fully loaded and parsed"),document.getElementById("aliceDogTokenBalance"),document.getElementById("aliceCatTokenBalance"),document.getElementById("aliceShareOfLiquidityPool"),document.getElementById("bobDogTokenBalance"),document.getElementById("bobCatTokenBalance"),document.getElementById("bobShareOfLiquidityPool"),document.getElementById("carolDogTokenBalance"),document.getElementById("carolCatTokenBalance"),document.getElementById("carolShareOfLiquidityPool"),document.getElementById("daveDogTokenBalance"),document.getElementById("daveCatTokenBalance"),document.getElementById("daveShareOfLiquidityPool"),document.getElementById("dexDogTokenBalance"),document.getElementById("dexCatTokenBalance"),document.getElementById("relativePriceDogTokenInCatToken"),document.getElementById("relativePriceCatTokenInDogToken"),document.getElementById("executeTradeBuyAliceButton").addEventListener("click",()=>g("Alice","buy")),document.getElementById("executeTradeSellAliceButton").addEventListener("click",()=>g("Alice","sell")),document.getElementById("executeTokenSelectAlice"),document.getElementById("executeAmountInputAlice"),document.getElementById("executeTradeBuyBobButton").addEventListener("click",()=>g("Bob","buy")),document.getElementById("executeTradeSellBobButton").addEventListener("click",()=>g("Bob","sell")),document.getElementById("executeTokenSelectBob"),document.getElementById("executeAmountInputBob"),document.getElementById("executeTradeBuyCarolButton").addEventListener("click",()=>g("Carol","buy")),document.getElementById("executeTradeSellCarolButton").addEventListener("click",()=>g("Carol","sell")),document.getElementById("executeTokenSelectCarol"),document.getElementById("executeAmountInputCarol"),document.getElementById("executeTradeBuyDaveButton").addEventListener("click",()=>g("Dave","buy")),document.getElementById("executeTradeSellDaveButton").addEventListener("click",()=>g("Dave","sell")),document.getElementById("executeTokenSelectDave"),document.getElementById("executeAmountInputDave");const r=document.getElementById("liquidityCatAmountInputAlice");document.getElementById("liquidityDogAmountInputAlice").addEventListener("input",T=>C(T,"Alice")),r.addEventListener("input",T=>f(T,"Alice"));const u=document.getElementById("depositLiquidityAliceButton"),B=document.getElementById("withdrawLiquidityAliceButton");u.addEventListener("click",()=>E("Alice")),B.addEventListener("click",()=>D("Alice"));const v=document.getElementById("liquidityCatAmountInputBob");document.getElementById("liquidityDogAmountInputBob").addEventListener("input",T=>C(T,"Bob")),v.addEventListener("input",T=>f(T,"Bob"));const I=document.getElementById("depositLiquidityBobButton"),h=document.getElementById("withdrawLiquidityBobButton");I.addEventListener("click",()=>E("Bob")),h.addEventListener("click",()=>D("Bob"));const M=document.getElementById("liquidityCatAmountInputCarol");document.getElementById("liquidityDogAmountInputCarol").addEventListener("input",T=>C(T,"Carol")),M.addEventListener("input",T=>f(T,"Carol"));const b=document.getElementById("depositLiquidityCarolButton"),H=document.getElementById("withdrawLiquidityCarolButton");b.addEventListener("click",()=>E("Carol")),H.addEventListener("click",()=>D("Carol"));const $=document.getElementById("liquidityCatAmountInputDave");document.getElementById("liquidityDogAmountInputDave").addEventListener("input",T=>C(T,"Dave")),$.addEventListener("input",T=>f(T,"Dave"));const q=document.getElementById("depositLiquidityDaveButton"),S=document.getElementById("withdrawLiquidityDaveButton");q.addEventListener("click",()=>E("Dave")),S.addEventListener("click",()=>D("Dave")),document.getElementById("aliceTotalValueInUSD"),document.getElementById("bobTotalValueInUSD"),document.getElementById("carolTotalValueInUSD"),document.getElementById("daveTotalValueInUSD"),document.getElementById("coinbaseArbitrageButton").addEventListener("click",()=>x()),document.getElementById("coinbaseArbitrageOneStepButton").addEventListener("click",()=>x(1));const P=document.getElementById("coinbaseDogTokenPriceInput"),w=document.getElementById("coinbaseCatTokenPriceInput");P.addEventListener("input",m),w.addEventListener("input",m),document.getElementById("airdropUserSelect"),document.getElementById("airdropTokenSelect"),document.getElementById("airdropAmountInput"),document.getElementById("airdropButton").addEventListener("click",F),document.getElementById("activityLogList"),N(),y(),m(),A=!0,k("Initialized.")});function k(e){if(A){const a=document.getElementById("activityLogList"),l=document.createElement("li");l.textContent=`${e}`,a.append(l),a.children.length>20&&a.removeChild(a.children[0])}}function m(){const e=parseFloat(coinbaseDogTokenPriceInput.value),a=parseFloat(coinbaseCatTokenPriceInput.value);["alice","bob","carol","dave"].forEach(t=>{const n=document.getElementById(`${t}TotalValueInUSD`).innerHTML,o=parseFloat(document.getElementById(`${t}DogTokenBalance`).innerHTML),c=parseFloat(document.getElementById(`${t}CatTokenBalance`).innerHTML),d=parseFloat(document.getElementById(`${t}ShareOfLiquidityPool`).innerHTML),r=parseFloat(dexDogTokenBalance.innerHTML),s=parseFloat(dexCatTokenBalance.innerHTML),u=d/100*(r*e+s*a),B=o*e+c*a+u;document.getElementById(`${t}TotalValueInUSD`).innerHTML=`$${i(B,2)}`,n!==`$${i(B,2)}`&&n!=="N/A"&&k(`${t.charAt(0).toUpperCase()+t.slice(1)}'s total asset value updated from ${n} to $${i(B,2)} USD.`)})}function F(){const e=airdropUserSelect.value;(e==="all"?["Alice","Bob","Carol","Dave"]:[e]).forEach(l=>O(l)),m()}function O(e){const a=airdropTokenSelect.value,l=parseFloat(airdropAmountInput.value);if(isNaN(l)||l<=0){alert("Please enter a valid amount greater than 0.");return}const t=e.toLowerCase(),n=parseFloat(document.getElementById(`${t}DogTokenBalance`).innerHTML),o=parseFloat(document.getElementById(`${t}CatTokenBalance`).innerHTML);a==="dogToken"?document.getElementById(`${t}DogTokenBalance`).innerHTML=i(n+l):a==="catToken"&&(document.getElementById(`${t}CatTokenBalance`).innerHTML=i(o+l)),k(`Airdropping ${l} ${a==="dogToken"?"Dog":"Cat"} Tokens to ${e}.`)}function x(e=1/0){const a=parseFloat(coinbaseDogTokenPriceInput.value),l=parseFloat(coinbaseCatTokenPriceInput.value),t=a/l,n=parseFloat(relativePriceDogTokenInCatToken.innerHTML),o=.01;if(t>n+o){console.log("Arbitrage opportunity: Buy Dog Token on DEX and sell on Coinbase");let c=parseFloat(dexDogTokenBalance.innerHTML),d=parseFloat(dexCatTokenBalance.innerHTML),r=0,s=0;for(;t>d/c&&e>0;){const u=1*d/(c-1);if(c<1||d<u)break;r+=1,s+=u,c-=1,d+=u,e-=1}r>0?(console.log(`Bought ${r} Dog Tokens on DEX for ${s} Cat Tokens`),dexDogTokenBalance.innerHTML=i(c),dexCatTokenBalance.innerHTML=i(d),y()):console.log("No arbitrage opportunity found")}else if(t<n-o){console.log("Arbitrage opportunity: Buy Cat Token on DEX and sell on Coinbase");let c=parseFloat(dexDogTokenBalance.innerHTML),d=parseFloat(dexCatTokenBalance.innerHTML),r=0,s=0;for(;t<d/c&&e>0;){const u=1*c/(d-1);if(d<1||c<u)break;r+=1,s+=u,d-=1,c+=u,e-=1}r>0?(console.log(`Bought ${r} Cat Tokens on DEX for ${s} Dog Tokens`),dexDogTokenBalance.innerHTML=i(c),dexCatTokenBalance.innerHTML=i(d),y()):console.log("No arbitrage opportunity found")}else console.log("No arbitrage opportunity found");m()}function E(e){const a=document.getElementById(`liquidityDogAmountInput${e}`),l=document.getElementById(`liquidityCatAmountInput${e}`),t=parseFloat(a.value),n=parseFloat(l.value);if(isNaN(t)||t<=0||isNaN(n)||n<=0){alert("Please enter a valid Token amount greater than 0.");return}console.log(`Depositing liquidity: ${e} wants to deposit ${t} Dog Tokens and ${n} Cat Tokens`);const o=e.toLowerCase(),c=parseFloat(document.getElementById(`${o}DogTokenBalance`).innerHTML),d=parseFloat(document.getElementById(`${o}CatTokenBalance`).innerHTML),r=parseFloat(document.getElementById(`${o}ShareOfLiquidityPool`).innerHTML),s=parseFloat(dexDogTokenBalance.innerHTML),u=parseFloat(dexCatTokenBalance.innerHTML),B=s+u;if(c<t){alert(`${e} does not have enough Dog Tokens to deposit.`);return}if(d<n){alert(`${e} does not have enough Cat Tokens to deposit.`);return}if(s===0&&u===0){if(t<=0||n<=0){alert("Initial liquidity must be greater than 0 for both Dog and Cat Tokens.");return}document.getElementById(`${o}ShareOfLiquidityPool`).innerHTML="100",dexDogTokenBalance.innerHTML=i(t),dexCatTokenBalance.innerHTML=i(n),document.getElementById(`${o}DogTokenBalance`).innerHTML=i(c-t),document.getElementById(`${o}CatTokenBalance`).innerHTML=i(d-n),y(),document.getElementById(`liquidityDogAmountInput${e}`).value="",document.getElementById(`liquidityCatAmountInput${e}`).value="";return}document.getElementById(`${o}DogTokenBalance`).innerHTML=i(c-t),document.getElementById(`${o}CatTokenBalance`).innerHTML=i(d-n);const L=(s+u)*r/100+t+n,I=B+t+n,h=L/I*100;document.getElementById(`${o}ShareOfLiquidityPool`).innerHTML=i(h),["alice","bob","carol","dave"].forEach(p=>{if(p!==o){const H=parseFloat(document.getElementById(`${p}ShareOfLiquidityPool`).innerHTML)*B/I;document.getElementById(`${p}ShareOfLiquidityPool`).innerHTML=i(H)}}),dexDogTokenBalance.innerHTML=i(s+t),dexCatTokenBalance.innerHTML=i(u+n),y(),document.getElementById(`liquidityDogAmountInput${e}`).value="",document.getElementById(`liquidityCatAmountInput${e}`).value=""}function D(e){const a=e.toLowerCase(),l=parseFloat(document.getElementById(`${a}ShareOfLiquidityPool`).innerHTML);if(l<=0){alert(`${e} does not have any share of the liquidity pool to withdraw.`);return}console.log(`Withdrawing liquidity: ${e} wants to withdraw their share of the liquidity pool`);const t=parseFloat(dexDogTokenBalance.innerHTML),n=parseFloat(dexCatTokenBalance.innerHTML),o=t+n,c=l/100*t,d=l/100*n,r=parseFloat(document.getElementById(`${a}DogTokenBalance`).innerHTML),s=parseFloat(document.getElementById(`${a}CatTokenBalance`).innerHTML);document.getElementById(`${a}DogTokenBalance`).innerHTML=i(r+c),document.getElementById(`${a}CatTokenBalance`).innerHTML=i(s+d),dexDogTokenBalance.innerHTML=i(t-c),dexCatTokenBalance.innerHTML=i(n-d),document.getElementById(`${a}ShareOfLiquidityPool`).innerHTML="0",["alice","bob","carol","dave"].forEach(B=>{if(B!==a)if(o-(c+d)<=0)document.getElementById(`${B}ShareOfLiquidityPool`).innerHTML="0";else{const L=parseFloat(document.getElementById(`${B}ShareOfLiquidityPool`).innerHTML)*o/(o-(c+d));L<0?document.getElementById(`${B}ShareOfLiquidityPool`).innerHTML="0":L>100?document.getElementById(`${B}ShareOfLiquidityPool`).innerHTML="100":document.getElementById(`${B}ShareOfLiquidityPool`).innerHTML=i(L)}}),k(`${e} withdrew all share of the liquidity pool: ${i(c)} Dog Tokens and ${i(d)} Cat Tokens.`),y()}function C(e,a){const l=e.target.value;if(isNaN(l)||l<=0){e.target.value="";return}else{const t=parseFloat(l),n=parseFloat(dexDogTokenBalance.innerHTML),o=parseFloat(dexCatTokenBalance.innerHTML);if(n===0&&o===0)return;if(n===0)return;if(o===0)return;{const c=t*o/n;document.getElementById(`liquidityCatAmountInput${a}`).value=i(c)}}}function f(e,a){const l=e.target.value;if(isNaN(l)||l<=0){e.target.value="";return}else{const t=parseFloat(l),n=parseFloat(dexDogTokenBalance.innerHTML),o=parseFloat(dexCatTokenBalance.innerHTML);if(n===0&&o===0)return;if(n===0)return;if(o===0)return;{const c=t*n/o;document.getElementById(`liquidityDogAmountInput${a}`).value=i(c)}}}function N(){aliceDogTokenBalance.innerHTML="0",aliceCatTokenBalance.innerHTML="0",aliceShareOfLiquidityPool.innerHTML="0",bobDogTokenBalance.innerHTML="0",bobCatTokenBalance.innerHTML="0",bobShareOfLiquidityPool.innerHTML="0",carolDogTokenBalance.innerHTML="0",carolCatTokenBalance.innerHTML="0",carolShareOfLiquidityPool.innerHTML="0",daveDogTokenBalance.innerHTML="0",daveCatTokenBalance.innerHTML="0",daveShareOfLiquidityPool.innerHTML="0",dexDogTokenBalance.innerHTML="0",dexCatTokenBalance.innerHTML="0",relativePriceDogTokenInCatToken.innerHTML="1",relativePriceCatTokenInDogToken.innerHTML="1",coinbaseDogTokenPriceInput.value="1",coinbaseCatTokenPriceInput.value="1"}function i(e,a=16){return e.toFixed(a).replace(/\.?0+$/,"")}function y(){const e=parseFloat(dexDogTokenBalance.innerHTML),a=parseFloat(dexCatTokenBalance.innerHTML);if(e===0&&a===0)relativePriceDogTokenInCatToken.innerHTML="N/A",relativePriceCatTokenInDogToken.innerHTML="N/A";else if(e===0)relativePriceDogTokenInCatToken.innerHTML="Infinity",relativePriceCatTokenInDogToken.innerHTML="0";else if(a===0)relativePriceDogTokenInCatToken.innerHTML="0",relativePriceCatTokenInDogToken.innerHTML="Infinity";else{const l=a/e,t=i(l),n=i(1/l);relativePriceDogTokenInCatToken.innerHTML=t,relativePriceCatTokenInDogToken.innerHTML=n}m()}function U(e,a,l,t){e=e.toLowerCase();const n=parseFloat(document.getElementById(`${e}DogTokenBalance`).innerHTML),o=parseFloat(document.getElementById(`${e}CatTokenBalance`).innerHTML),c=parseFloat(dexDogTokenBalance.innerHTML),d=parseFloat(dexCatTokenBalance.innerHTML);if(a==="dogToken"){if(l==="sell"){if(n<t){alert(`${e.charAt(0).toUpperCase()+e.slice(1)} does not have enough Dog Tokens to sell.`);return}const r=t*d/(c+t);document.getElementById(`${e}DogTokenBalance`).innerHTML=i(n-t),document.getElementById(`${e}CatTokenBalance`).innerHTML=i(o+r),dexDogTokenBalance.innerHTML=i(c+t),dexCatTokenBalance.innerHTML=i(d-r)}else if(l==="buy"){if(c<t){alert(`DEX does not have enough Dog Tokens for ${e.charAt(0).toUpperCase()+e.slice(1)} to buy.`);return}const r=t*d/(c-t);if(o<r){alert(`${e.charAt(0).toUpperCase()+e.slice(1)} does not have enough Cat Tokens to buy Dog Tokens.`);return}document.getElementById(`${e}DogTokenBalance`).innerHTML=i(n+t),document.getElementById(`${e}CatTokenBalance`).innerHTML=i(o-r),dexDogTokenBalance.innerHTML=i(c-t),dexCatTokenBalance.innerHTML=i(d+r)}}else if(a==="catToken"){if(l==="sell"){if(o<t){alert(`${e.charAt(0).toUpperCase()+e.slice(1)} does not have enough Cat Tokens to sell.`);return}const r=t*c/(d+t);document.getElementById(`${e}CatTokenBalance`).innerHTML=i(o-t),document.getElementById(`${e}DogTokenBalance`).innerHTML=i(n+r),dexCatTokenBalance.innerHTML=i(d+t),dexDogTokenBalance.innerHTML=i(c-r)}else if(l==="buy"){if(d<t){alert(`DEX does not have enough Cat Tokens for ${e.charAt(0).toUpperCase()+e.slice(1)} to buy.`);return}const r=t*c/(d-t);if(n<r){alert(`${e.charAt(0).toUpperCase()+e.slice(1)} does not have enough Dog Tokens to buy Cat Tokens.`);return}document.getElementById(`${e}CatTokenBalance`).innerHTML=i(o+t),document.getElementById(`${e}DogTokenBalance`).innerHTML=i(n-r),dexCatTokenBalance.innerHTML=i(d-t),dexDogTokenBalance.innerHTML=i(c+r)}}k(`${e} ${l} ${t} ${a==="dogToken"?"Dog":"Cat"} Tokens.`),y()}function g(e,a){const l=document.getElementById(`executeTokenSelect${e}`).value,t=parseFloat(document.getElementById(`executeAmountInput${e}`).value);if(isNaN(t)||t<=0){alert("Please enter a valid amount greater than 0.");return}console.log(`Executing trade: ${e} wants to ${a} ${t} of ${l} Token`),U(e,l,a,t),m()}
