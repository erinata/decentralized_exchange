(function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))t(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&t(i)}).observe(document,{childList:!0,subtree:!0});function c(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function t(n){if(n.ep)return;n.ep=!0;const o=c(n);fetch(n.href,o)}})();document.addEventListener("DOMContentLoaded",()=>{console.log("DOM fully loaded and parsed"),document.getElementById("aliceDogTokenBalance"),document.getElementById("aliceCatTokenBalance"),document.getElementById("aliceShareOfLiquidityPool"),document.getElementById("bobDogTokenBalance"),document.getElementById("bobCatTokenBalance"),document.getElementById("bobShareOfLiquidityPool"),document.getElementById("carolDogTokenBalance"),document.getElementById("carolCatTokenBalance"),document.getElementById("carolShareOfLiquidityPool"),document.getElementById("daveDogTokenBalance"),document.getElementById("daveCatTokenBalance"),document.getElementById("daveShareOfLiquidityPool"),document.getElementById("dexDogTokenBalance"),document.getElementById("dexCatTokenBalance"),document.getElementById("relativePriceDogTokenInCatToken"),document.getElementById("relativePriceCatTokenInDogToken"),document.getElementById("executeTradeBuyAliceButton").addEventListener("click",()=>g("Alice","buy")),document.getElementById("executeTradeSellAliceButton").addEventListener("click",()=>g("Alice","sell")),document.getElementById("executeTokenSelectAlice"),document.getElementById("executeAmountInputAlice"),document.getElementById("executeTradeBuyBobButton").addEventListener("click",()=>g("Bob","buy")),document.getElementById("executeTradeSellBobButton").addEventListener("click",()=>g("Bob","sell")),document.getElementById("executeTokenSelectBob"),document.getElementById("executeAmountInputBob"),document.getElementById("executeTradeBuyCarolButton").addEventListener("click",()=>g("Carol","buy")),document.getElementById("executeTradeSellCarolButton").addEventListener("click",()=>g("Carol","sell")),document.getElementById("executeTokenSelectCarol"),document.getElementById("executeAmountInputCarol"),document.getElementById("executeTradeBuyDaveButton").addEventListener("click",()=>g("Dave","buy")),document.getElementById("executeTradeSellDaveButton").addEventListener("click",()=>g("Dave","sell")),document.getElementById("executeTokenSelectDave"),document.getElementById("executeAmountInputDave");const r=document.getElementById("liquidityCatAmountInputAlice");document.getElementById("liquidityDogAmountInputAlice").addEventListener("input",s=>C(s,"Alice")),r.addEventListener("input",s=>f(s,"Alice"));const u=document.getElementById("depositLiquidityAliceButton"),T=document.getElementById("withdrawLiquidityAliceButton");u.addEventListener("click",()=>E("Alice")),T.addEventListener("click",()=>D("Alice"));const k=document.getElementById("liquidityCatAmountInputBob");document.getElementById("liquidityDogAmountInputBob").addEventListener("input",s=>C(s,"Bob")),k.addEventListener("input",s=>f(s,"Bob"));const v=document.getElementById("depositLiquidityBobButton"),m=document.getElementById("withdrawLiquidityBobButton");v.addEventListener("click",()=>E("Bob")),m.addEventListener("click",()=>D("Bob"));const H=document.getElementById("liquidityCatAmountInputCarol");document.getElementById("liquidityDogAmountInputCarol").addEventListener("input",s=>C(s,"Carol")),H.addEventListener("input",s=>f(s,"Carol"));const h=document.getElementById("depositLiquidityCarolButton"),b=document.getElementById("withdrawLiquidityCarolButton");h.addEventListener("click",()=>E("Carol")),b.addEventListener("click",()=>D("Carol"));const x=document.getElementById("liquidityCatAmountInputDave");document.getElementById("liquidityDogAmountInputDave").addEventListener("input",s=>C(s,"Dave")),x.addEventListener("input",s=>f(s,"Dave"));const A=document.getElementById("depositLiquidityDaveButton"),q=document.getElementById("withdrawLiquidityDaveButton");A.addEventListener("click",()=>E("Dave")),q.addEventListener("click",()=>D("Dave")),document.getElementById("aliceTotalValueInUSD"),document.getElementById("bobTotalValueInUSD"),document.getElementById("carolTotalValueInUSD"),document.getElementById("daveTotalValueInUSD"),document.getElementById("coinbaseArbitrageButton").addEventListener("click",()=>M()),document.getElementById("coinbaseArbitrageOneStepButton").addEventListener("click",()=>M(1));const $=document.getElementById("coinbaseDogTokenPriceInput"),S=document.getElementById("coinbaseCatTokenPriceInput");$.addEventListener("input",y),S.addEventListener("input",y),document.getElementById("airdropUserSelect"),document.getElementById("airdropTokenSelect"),document.getElementById("airdropAmountInput"),document.getElementById("airdropButton").addEventListener("click",P),w(),L(),y()});function y(){const e=parseFloat(coinbaseDogTokenPriceInput.value),l=parseFloat(coinbaseCatTokenPriceInput.value);["alice","bob","carol","dave"].forEach(t=>{const n=parseFloat(document.getElementById(`${t}DogTokenBalance`).innerHTML),o=parseFloat(document.getElementById(`${t}CatTokenBalance`).innerHTML),i=parseFloat(document.getElementById(`${t}ShareOfLiquidityPool`).innerHTML),d=parseFloat(dexDogTokenBalance.innerHTML),r=parseFloat(dexCatTokenBalance.innerHTML),B=i/100*(d*e+r*l),u=n*e+o*l+B;document.getElementById(`${t}TotalValueInUSD`).innerHTML=`$${a(u,2)}`})}function P(){const e=airdropUserSelect.value;(e==="all"?["Alice","Bob","Carol","Dave"]:[e]).forEach(c=>F(c)),y()}function F(e){const l=airdropTokenSelect.value,c=parseFloat(airdropAmountInput.value);if(isNaN(c)||c<=0){alert("Please enter a valid amount greater than 0.");return}console.log(`Airdropping ${c} of ${l} Token to ${e}`);const t=e.toLowerCase(),n=parseFloat(document.getElementById(`${t}DogTokenBalance`).innerHTML),o=parseFloat(document.getElementById(`${t}CatTokenBalance`).innerHTML);l==="dogToken"?document.getElementById(`${t}DogTokenBalance`).innerHTML=a(n+c):l==="catToken"&&(document.getElementById(`${t}CatTokenBalance`).innerHTML=a(o+c))}function M(e=1/0){const l=parseFloat(coinbaseDogTokenPriceInput.value),c=parseFloat(coinbaseCatTokenPriceInput.value),t=l/c,n=parseFloat(relativePriceDogTokenInCatToken.innerHTML),o=.01;if(t>n+o){console.log("Arbitrage opportunity: Buy Dog Token on DEX and sell on Coinbase");let i=parseFloat(dexDogTokenBalance.innerHTML),d=parseFloat(dexCatTokenBalance.innerHTML),r=0,B=0;for(;t>d/i&&e>0;){const u=1*d/(i-1);if(i<1||d<u)break;r+=1,B+=u,i-=1,d+=u,e-=1}r>0?(console.log(`Bought ${r} Dog Tokens on DEX for ${B} Cat Tokens`),dexDogTokenBalance.innerHTML=a(i),dexCatTokenBalance.innerHTML=a(d),L()):console.log("No arbitrage opportunity found")}else if(t<n-o){console.log("Arbitrage opportunity: Buy Cat Token on DEX and sell on Coinbase");let i=parseFloat(dexDogTokenBalance.innerHTML),d=parseFloat(dexCatTokenBalance.innerHTML),r=0,B=0;for(;t<d/i&&e>0;){const u=1*i/(d-1);if(d<1||i<u)break;r+=1,B+=u,d-=1,i+=u,e-=1}r>0?(console.log(`Bought ${r} Cat Tokens on DEX for ${B} Dog Tokens`),dexDogTokenBalance.innerHTML=a(i),dexCatTokenBalance.innerHTML=a(d),L()):console.log("No arbitrage opportunity found")}else console.log("No arbitrage opportunity found");y()}function E(e){const l=document.getElementById(`liquidityDogAmountInput${e}`),c=document.getElementById(`liquidityCatAmountInput${e}`),t=parseFloat(l.value),n=parseFloat(c.value);if(isNaN(t)||t<=0||isNaN(n)||n<=0){alert("Please enter a valid Token amount greater than 0.");return}console.log(`Depositing liquidity: ${e} wants to deposit ${t} Dog Tokens and ${n} Cat Tokens`);const o=e.toLowerCase(),i=parseFloat(document.getElementById(`${o}DogTokenBalance`).innerHTML),d=parseFloat(document.getElementById(`${o}CatTokenBalance`).innerHTML),r=parseFloat(document.getElementById(`${o}ShareOfLiquidityPool`).innerHTML),B=parseFloat(dexDogTokenBalance.innerHTML),u=parseFloat(dexCatTokenBalance.innerHTML),T=B+u;if(i<t){alert(`${e} does not have enough Dog Tokens to deposit.`);return}if(d<n){alert(`${e} does not have enough Cat Tokens to deposit.`);return}if(B===0&&u===0){if(t<=0||n<=0){alert("Initial liquidity must be greater than 0 for both Dog and Cat Tokens.");return}document.getElementById(`${o}ShareOfLiquidityPool`).innerHTML="100",dexDogTokenBalance.innerHTML=a(t),dexCatTokenBalance.innerHTML=a(n),document.getElementById(`${o}DogTokenBalance`).innerHTML=a(i-t),document.getElementById(`${o}CatTokenBalance`).innerHTML=a(d-n),L();return}const k=t+n,I=k/(T+k)*100;document.getElementById(`${o}ShareOfLiquidityPool`).innerHTML=a(r+I),["alice","bob","carol","dave"].forEach(m=>{if(m!==o){const p=parseFloat(document.getElementById(`${m}ShareOfLiquidityPool`).innerHTML)*T/(T+k);p<0?document.getElementById(`${m}ShareOfLiquidityPool`).innerHTML="0":p>100?document.getElementById(`${m}ShareOfLiquidityPool`).innerHTML="100":document.getElementById(`${m}ShareOfLiquidityPool`).innerHTML=a(p)}}),document.getElementById(`${o}DogTokenBalance`).innerHTML=a(i-t),document.getElementById(`${o}CatTokenBalance`).innerHTML=a(d-n),dexDogTokenBalance.innerHTML=a(B+t),dexCatTokenBalance.innerHTML=a(u+n),L()}function D(e){const l=e.toLowerCase(),c=parseFloat(document.getElementById(`${l}ShareOfLiquidityPool`).innerHTML);if(c<=0){alert(`${e} does not have any share of the liquidity pool to withdraw.`);return}console.log(`Withdrawing liquidity: ${e} wants to withdraw their share of the liquidity pool`);const t=parseFloat(dexDogTokenBalance.innerHTML),n=parseFloat(dexCatTokenBalance.innerHTML),o=t+n,i=c/100*t,d=c/100*n,r=parseFloat(document.getElementById(`${l}DogTokenBalance`).innerHTML),B=parseFloat(document.getElementById(`${l}CatTokenBalance`).innerHTML);document.getElementById(`${l}DogTokenBalance`).innerHTML=a(r+i),document.getElementById(`${l}CatTokenBalance`).innerHTML=a(B+d),dexDogTokenBalance.innerHTML=a(t-i),dexCatTokenBalance.innerHTML=a(n-d),document.getElementById(`${l}ShareOfLiquidityPool`).innerHTML="0",["alice","bob","carol","dave"].forEach(T=>{if(T!==l)if(o-(i+d)<=0)document.getElementById(`${T}ShareOfLiquidityPool`).innerHTML="0";else{const I=parseFloat(document.getElementById(`${T}ShareOfLiquidityPool`).innerHTML)*o/(o-(i+d));I<0?document.getElementById(`${T}ShareOfLiquidityPool`).innerHTML="0":I>100?document.getElementById(`${T}ShareOfLiquidityPool`).innerHTML="100":document.getElementById(`${T}ShareOfLiquidityPool`).innerHTML=a(I)}}),L()}function C(e,l){const c=e.target.value;if(isNaN(c)||c<=0){e.target.value="";return}else{const t=parseFloat(c),n=parseFloat(dexDogTokenBalance.innerHTML),o=parseFloat(dexCatTokenBalance.innerHTML);if(n===0&&o===0)return;if(n===0)return;if(o===0)return;{const i=t*o/n;document.getElementById(`liquidityCatAmountInput${l}`).value=a(i)}}}function f(e,l){const c=e.target.value;if(isNaN(c)||c<=0){e.target.value="";return}else{const t=parseFloat(c),n=parseFloat(dexDogTokenBalance.innerHTML),o=parseFloat(dexCatTokenBalance.innerHTML);if(n===0&&o===0)return;if(n===0)return;if(o===0)return;{const i=t*n/o;document.getElementById(`liquidityDogAmountInput${l}`).value=a(i)}}}function w(){aliceDogTokenBalance.innerHTML="0",aliceCatTokenBalance.innerHTML="0",aliceShareOfLiquidityPool.innerHTML="0",bobDogTokenBalance.innerHTML="0",bobCatTokenBalance.innerHTML="0",bobShareOfLiquidityPool.innerHTML="0",carolDogTokenBalance.innerHTML="0",carolCatTokenBalance.innerHTML="0",carolShareOfLiquidityPool.innerHTML="0",daveDogTokenBalance.innerHTML="0",daveCatTokenBalance.innerHTML="0",daveShareOfLiquidityPool.innerHTML="0",dexDogTokenBalance.innerHTML="0",dexCatTokenBalance.innerHTML="0",relativePriceDogTokenInCatToken.innerHTML="1",relativePriceCatTokenInDogToken.innerHTML="1",coinbaseDogTokenPriceInput.value="1",coinbaseCatTokenPriceInput.value="1"}function a(e,l=16){return e.toFixed(l).replace(/\.?0+$/,"")}function L(){const e=parseFloat(dexDogTokenBalance.innerHTML),l=parseFloat(dexCatTokenBalance.innerHTML);if(e===0&&l===0)relativePriceDogTokenInCatToken.innerHTML="N/A",relativePriceCatTokenInDogToken.innerHTML="N/A";else if(e===0)relativePriceDogTokenInCatToken.innerHTML="Infinity",relativePriceCatTokenInDogToken.innerHTML="0";else if(l===0)relativePriceDogTokenInCatToken.innerHTML="0",relativePriceCatTokenInDogToken.innerHTML="Infinity";else{const c=l/e,t=a(c),n=a(1/c);relativePriceDogTokenInCatToken.innerHTML=t,relativePriceCatTokenInDogToken.innerHTML=n}y()}function O(e,l,c,t){e=e.toLowerCase();const n=parseFloat(document.getElementById(`${e}DogTokenBalance`).innerHTML),o=parseFloat(document.getElementById(`${e}CatTokenBalance`).innerHTML),i=parseFloat(dexDogTokenBalance.innerHTML),d=parseFloat(dexCatTokenBalance.innerHTML);if(l==="dogToken"){if(c==="sell"){if(n<t){alert(`${e.charAt(0).toUpperCase()+e.slice(1)} does not have enough Dog Tokens to sell.`);return}const r=t*d/(i+t);document.getElementById(`${e}DogTokenBalance`).innerHTML=a(n-t),document.getElementById(`${e}CatTokenBalance`).innerHTML=a(o+r),dexDogTokenBalance.innerHTML=a(i+t),dexCatTokenBalance.innerHTML=a(d-r)}else if(c==="buy"){if(i<t){alert(`DEX does not have enough Dog Tokens for ${e.charAt(0).toUpperCase()+e.slice(1)} to buy.`);return}const r=t*d/(i-t);if(o<r){alert(`${e.charAt(0).toUpperCase()+e.slice(1)} does not have enough Cat Tokens to buy Dog Tokens.`);return}document.getElementById(`${e}DogTokenBalance`).innerHTML=a(n+t),document.getElementById(`${e}CatTokenBalance`).innerHTML=a(o-r),dexDogTokenBalance.innerHTML=a(i-t),dexCatTokenBalance.innerHTML=a(d+r)}}else if(l==="catToken"){if(c==="sell"){if(o<t){alert(`${e.charAt(0).toUpperCase()+e.slice(1)} does not have enough Cat Tokens to sell.`);return}const r=t*i/(d+t);document.getElementById(`${e}CatTokenBalance`).innerHTML=a(o-t),document.getElementById(`${e}DogTokenBalance`).innerHTML=a(n+r),dexCatTokenBalance.innerHTML=a(d+t),dexDogTokenBalance.innerHTML=a(i-r)}else if(c==="buy"){if(d<t){alert(`DEX does not have enough Cat Tokens for ${e.charAt(0).toUpperCase()+e.slice(1)} to buy.`);return}const r=t*i/(d-t);if(n<r){alert(`${e.charAt(0).toUpperCase()+e.slice(1)} does not have enough Dog Tokens to buy Cat Tokens.`);return}document.getElementById(`${e}CatTokenBalance`).innerHTML=a(o+t),document.getElementById(`${e}DogTokenBalance`).innerHTML=a(n-r),dexCatTokenBalance.innerHTML=a(d-t),dexDogTokenBalance.innerHTML=a(i+r)}}L()}function g(e,l){const c=document.getElementById(`executeTokenSelect${e}`).value,t=parseFloat(document.getElementById(`executeAmountInput${e}`).value);if(isNaN(t)||t<=0){alert("Please enter a valid amount greater than 0.");return}console.log(`Executing trade: ${e} wants to ${l} ${t} of ${c} Token`),O(e,c,l,t),y()}
